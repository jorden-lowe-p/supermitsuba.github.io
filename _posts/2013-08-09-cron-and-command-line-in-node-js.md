---
id: 51
title: Cron and Command line in Node.js
date: 2013-08-09T00:00:00+00:00
author: Jorden
layout: post
guid: http://www.fbombcode.com/title/Cron_and_Command_line_in_Node.js
permalink: /2013/08/09/cron-and-command-line-in-node-js/
categories:
  - javascript
  - node.js
tags:
  - cron
  - javascript
  - node.js
---
 <p> I found out that Macs don&#8217;t have cron, like in linux. They do have something similar called launchd, but I wanted to execute something as admin, and all sorts of stuff. Luckily, my favorite platform, node, has a <a href="https://github.com/ncb000gt/node-cron">cron</a> and a <a href="http://nodejs.org/api/child\_process.html">command line</a> to simulate a cron system. </p> <p> First thing to get use to is the format. It is simple, but there are some things that you need to know about it. There is 6 fields, seperated by a space. Each field is a time slot, so first is second, minute, hour, day of month, month, day of the week. After that, you have to tell how each field should run, let&#8217;s check out the table below: </p> <table class="table table-striped"> <thead> <tr> <th> Symbol </th> <th> Meaning </th> <th> Example </th> </tr> </thead> <tbody> <tr> <td> \* </td> <td> Star means run on all options for that field </td> <td> i.e. \* \* \* \* \* \* &#8211; means run every second of every minute of every hour, and so on. </td> </tr> <tr> <td> # </td> <td> Placing a number means to run it specifically for that field. </td> <td> i.e. 1 \* \* \* \* \* &#8211; means to run every minute, only on the first second. </td> </tr> <tr> <td> , </td> <td> Placing a comma between numbers tells the cron job multiple runnings. </td> <td> i.e. 3,5,7,9 \* \* \* \* \* &#8211; means to run every minute, on the 3rd, 5th, 7th and 9th second. (so 4 times a minute) </td> </tr> <tr> <td> &#8211; </td> <td> A dash creates a range. </td> <td> i.e. 3-10 \* \* \* \* \* &#8211; means run on the 3rd, 4th, 5th, 6th, 7th, 8th, 9th, 10th second of every minute. (8 times) </td> </tr> <tr> <td> / </td> <td> Divide the section and run it every time it is divisable by that number. </td> <td> i.e. \*/10 \* \* \* \* \* &#8211; run every 10 seconds, \* \*/10 \* \* \* \* &#8211; run every 10 minutes </td> </tr> </tbody> </table> <p> Those are the rules. There are more, but these are good enough to describe what timings you may need. Let&#8217;s check out some code then: </p> <pre class="formatCode"> var cronJob = require('cron').CronJob; new cronJob('\* \* \* \* \* \*', function(){ console.log('You will see this message every second'); }, null, true, "America/Los\_Angeles"); </pre> <p> So that code is pretty simple, it runs every second and prints to console. Let&#8217;s now add some command line code: </p> <pre class="formatCode"> var obj = new Date(); var filename = obj.getFullYear()+"\_"+(obj.getMonth()+1)+"\_"+obj.getDate()+"\_"+obj.getHours()+"\_"+obj.getMinutes(); child = exec("redis-cli INFO > "+filename+".txt", function (error, stdout, stderr) { if(stderr){ sys.print('error: ' + stderr); } } ); }, function(){}, true); </pre> <p> I have been working with redis, and needed to output command information to a text file, so I created this script to create log file from redis. Now, if we put all of this together: </p> <pre class="formatCode"> var sys = require('sys') var exec = require('child\_process').exec; var child; var cronJob = require('cron').CronJob; var a = new cronJob('0 0 \* \* \* \*', function(d){ var obj = new Date(); var val = obj.getFullYear()+"\_"+(obj.getMonth()+1)+"\_"+obj.getDate()+"\_"+obj.getHours()+"_"+obj.getMinutes(); child = exec("redis-cli INFO > "+val+".txt", function (error, stdout, stderr) { if(stderr){ sys.print('error: ' + stderr); } } ); }, function(){}, true); </pre> <p> This code runs every first second, of the first minute, every hour, to log a text file from redis, with a file name based on the date time. Booooooooom! </p>